# あなたの業務をAIがサポート！Anthropicの『Agent Skills』とは

都内IT企業にてデータサイエンティストをしています｡  
先日[LINE DC Generative AI Meetup #7](https://linedevelopercommunity.connpass.com/event/371716/)に行ってきました!!  
とても刺激を受けたので初の投稿をしてみたいと思います｡

![LINE DC Generative AI Meetup #7](img/LINE_DC_Generative_AI_Meetup7.png)

今､巷で話題となっているAnthropicから新しく発表された新機能｢Agent Skills｣について解説してみたいと思います!!  
(もうたくさん記事が出ていますが自分自身の勉強のためにも)

## 1. Agent Skillsとはそもそも何!?

Agent Skillsは、2025年10月17日にAnthropicから公開されたClaudeの新機能です。

### 基本的な概念

Agent Skillsとは、端的に言えば「AIに特定のタスクを教え込むための、手順書と道具箱をまとめたフォルダ」です。  Claudeに専門的なタスクを実行させるためのパッケージとして機能します。

### 最大の特徴：モデル主導の起動

従来のシステムとの最大の違いは、**モデル主導の起動**にあります。  
ユーザーが明示的に命令しなくても、Claude自身が会話の流れから「このタスクには、あのスキルが役立ちそうだ」と判断し、自律的にスキルを呼び出して実行してくれます｡

## MCP vs Agent Skills
### MCPによるコンテキストウィンドウの飽和について

従来のAIエージェントが直面する根本的な課題として、**コンテキストウィンドウの飽和**があります。  
※コンテキストウィンドウとはAIが一度に処理できるトークンの限界量です｡(Appendixに各社のコンテキストウィンドウを載せています)

### ツール増加による性能低下のジレンマ

AIエージェントの性能は接続される「ツール」の数や質に良い意味でも悪い意味でも大きく依存します｡

- **ツールが多い** → エージェントのできることは増える
- **ツールが多すぎる** → AIが「どのタスクに、どのツールを使えば最適なのか？」という判断に迷い始める

### MCPツールの具体的な問題

**コンテキストウィンドウの圧迫メカニズム：**

1. **起動時の情報読み込み**: AIエージェントは起動時に、利用可能なすべてのツールの定義（何ができるツールなのか、どう使うのか）をコンテキストウィンドウに読み込みます

2. **ツール数増加の影響**: ツールの数が増えれば増えるほど、この初期情報だけでコンテキストウィンドウが圧迫されます

3. **対話領域の縮小**: 結果として、ユーザーとの対話や思考に使える領域が狭くなってしまいます

![コンテキストウィンドウとツールの関係](img/context-window-thinking-tools.svg)

### コンテキストウィンドウの重要性

AIエージェントが一度に扱える情報量=**コンテキストウィンドウ**は重要かつ有限なリソースです。  
  
ある環境では、MCPツールがコンテキストウィンドウの約30%以上を占めていた状況がありました。  

これらの課題を解決し、**ツールの多さ**と**性能の高さ**を両立させるために生まれたのが、**Agent Skills**という新しいアプローチになります。


### MCPとAgent Skillsの違い

最初は｢Agent SkillsとFunction Callingの一般化であるMCPと何が違うのか？」と思いました｡  
Agent Skillsは  
**MCPやツールといった個別の要素を、より上位の概念で『抽象化』し、パッケージ化する仕組み**  
と言えるそうです｡

| 項目 | MCP | Agent Skills |
| :--- | :--- | :--- |
| **役割** | AIエージェントに外部「ツール」を直接追加・拡張する仕組み | 複数のツールや手順、知識を一つの「スキル」としてパッケージ化する仕組み |
| **読み込み単位** | **全ての**ツールの定義 | **スキル名と簡単な説明**のみ。必要に応じて詳細を読み込む |
| **AIの負荷** | ツールが多いと、AIがどのツールを使うべきか「迷い」が生じ、性能が低下する可能性がある | 最初に読み込む情報が少ないためAIの「迷い」が減り、タスクへの集中力が高まる |
| **管理** | 類似ツールが増えると管理が複雑になり精度が落ちる | 関連するツールを一つのパッケージにまとめることでシンプルに管理可能 |


## Agent Skillsの仕組み

### 段階的開示（Progressive Disclosure）について

Agent Skillsの核心には、「Progressive Disclosure（段階的開示）」という設計思想があります。これは、情報を一度にすべて見せるのではなく、必要な情報だけを、必要なタイミングで段階的にAIに開示することで、コンテキストウィンドウを効率的に利用する仕組みです｡

従来のMCPツールでは、AIエージェントが起動時に利用可能なすべてのツールの定義を一度に読み込むため、ツール数が増えるとコンテキストウィンドウが圧迫され、性能が低下する問題がありました。段階的開示は、この問題を根本的に解決する革新的なアプローチです。

### 3段階の読み込み戦略

#### レベル1：メタデータ（常に読み込まれる）

システムが起動した時に、各スキル(Skill.mdファイル)のスキルの名前（name）と簡単な説明（description）のメタデータが書かれた**YAMLフロントマター**のみが読み込まれ､システムプロンプトにセットされます｡
  
この段階では、Claudeは各スキルが「何ができるか」と「いつ使うべきか」という基本的な情報だけを把握します。  
1スキルあたりのトークン量は100程度と考えられており､仮に100個のスキルがインストールされていても合計で約10,000トークンしか消費せず、これは200,000トークンのコンテキストウィンドウのわずか5%です。

##### YAML Frontmatter（メタデータ部分）
```yaml
---
name: pdf
description: Comprehensive PDF toolkit for extracting text and tables, merging/splitting documents, and filling-out forms.
---
```

![skills.md](img/skills.md.png)

#### レベル2：指示（スキルがトリガーされたときに読み込まれる）

ユーザーのリクエストを分析し、特定のスキルが関連すると判断された時にSKILL.md本体の指示とガイダンスが読み込まれます。
通常3,000~5,000トークンが想定されます｡

この段階では、Claudeは具体的な作業手順、使用するツール、注意事項などの詳細な指示を受け取ります。

##### Markdown（本文部分）
````
**Overview**
This guide covers essential PDF processing operations using Python libraries and command-line tools. For advanced features, JavaScript libraries, and detailed examples, see ./reference.md. If you need to fill out a PDF form, read ./forms.md and follow its instructions.

**Quick Start**
```python
from pypdf import PdfReader, PdfWriter

# Read a PDF
reader = PdfReader("document.pdf")
print(f"Pages: {len(reader.pages)}")
```
````

#### レベル3：リソースとコード（必要に応じて読み込まれる）

SKILL.mdの内容だけでは不十分な場合、必要に応じて追加のマークダウンファイル、実行可能スクリプト、参照資料が読み込まれます。この段階では、実質的に無制限のトークンコスト（bash経由で実行されるため）で、より詳細な情報にアクセスできます。

これは、専門書の参考文献や付録を参照する段階に相当します。例えば、PDF処理スキルで複雑なフォーム入力が必要な場合、FORMS.mdファイルが読み込まれ、さらにAPIドキュメントやサンプルコードが参照されることもあります。

##### ディレクトリ構成の例
```
pdf-skill/
├── SKILL.md (main instructions)
├── FORMS.md (form-filling guide)
├── REFERENCE.md (detailed API reference)
└── scripts/
    └── fill_form.py (utility script)
```

![additional_content.png](img/additional_content.png)

##### ※Claude がスキル コンテンツにアクセスする方法：
スキルがトリガーされると、Claude は bash を使用してファイルシステムから SKILL.md を読み込み、その指示をコンテキスト ウィンドウに取り込みます。これらの指示が他のファイル（FORMS.md やデータベース スキーマなど）を参照している場合、Claude は追加の bash コマンドを使用してそれらのファイルも読み込みます。指示が実行可能スクリプトについて言及している場合、Claude は bash 経由でそれらを実行し、出力のみを受け取ります（**スクリプト コード自体はコンテキストに入りません**）。

### 実際の対話とskills呼び出しのイメージ
Tool use: Bash("~")でスクリプトコードはコンテキスト内に入っていない｡
![skills_and_context_window.png](img/skills_and_context_window.png)

### アーキテクチャの特徴

Agent Skillsのアーキテクチャには3つの重要な特徴があります。

#### ファイルシステムベース
Claudeは仮想マシン環境で動作し、ファイルシステムアクセスを備えたbashコマンドでスキルと対話します。これにより、オンデマンドでファイルアクセスが可能になり、必要な情報だけを動的に読み込むことができます。従来のAPIベースのアプローチとは異なり、ファイルシステムの柔軟性を活用して、より効率的な情報管理を実現しています。

#### 効率的なスクリプト実行
スクリプトのコードはコンテキストウィンドウに読み込まれず、スクリプトの出力のみがトークンを消費します。これにより、決定論的な操作を提供しながら、コンテキストの無駄遣いを防ぐことができます。例えば、複雑なデータ処理スクリプトが1,000行のコードを持っていても、そのコードはコンテキストに含まれず、処理結果の「成功」や「エラー: ファイルが見つかりません」といった短いメッセージのみがトークンを消費します。

#### バンドルコンテンツの制限なし
ファイルはアクセスされるまでコンテキストを消費しないため、包括的なAPIドキュメンテーション、大規模なデータセット、広範な例を含めることが可能です。使用されないバンドルコンテンツ(スキルフォルダ内に含まれるすべてのファイル群)に対するコンテキストのペナルティがありません。これにより、スキル開発者は「使うかもしれない」情報も含めて、より包括的なスキルを作成することができます。

![Agent_Skills_Computer.png](img/Agent_Skills_Computer.png)

## 4. 3つの実行環境について

## 5. 具体的な活用例
### 想定される活用例

### Anthropicが公式で出しているskills

## 

##

## Appendix
### 主要AIモデルのコンテキストウィンドウ比較

**Claude（Anthropic）**
- Claude 3.5 Sonnet: 200,000トークン
- Claude 4 Sonnet: 1,000,000トークン

**GPT（OpenAI）**
- GPT-4o: 128,000トークン
- GPT-4.1: 約1,000,000トークン
- GPT-o系: 200,000トークン

**Gemini（Google）**
- Gemini 2.5 Pro: 1,000,000トークン
- Gemini 2.5 Flash: 1,000,000トークン

**トークン数の目安**
- 日本語: 1文字 ≈ 1~3トークン
- 英語: 1単語 ≈ 1.3トークン
- 例: 200,000トークン ≈ 約7~20万文字（日本語）